

# app5.js ドキュメント

## 概要

ファイル名 | 説明
-|-
app5.js | プログラム本体
janken.ejs | じゃんけんをしよう！の入力画面を表示する
shiritori.ejs | 逆⚡️しりとりヘルパー‼️の入力画面を表示する
message.ejs | アメ❤️ムチ文字数カウンターの入力画面を表示する




### app5.js の概要


app5.js は, Node.js と Express を使用して作成された Web アプリケーションで, 3つの主要な機能を使用することができる. それぞれの機能は, ブラウザを通じてインタラクティブに動作し, EJS（Embedded JavaScript）テンプレートエンジンを使って画面がレンダリングされる. 以下は, それぞれの機能についての概要である. 

#### 1. じゃんけん機能

##### 説明:
 「グー」「チョキ」「パー」のいずれかを選択し, コンピュータとじゃんけんを行うことができる. 勝敗が判定され, 「勝ち」「負け」「引き分け」といった結果が表示される. 勝ち数と負け数がカウントされ, 合計回数も記録される. 
##### 機能の詳細:
ユーザーの選択はラジオボタンから選択することができる. 
コンピュータの手はランダムに生成される. 
勝敗の判定後, 結果と更新された勝ち数・負け数・合計回数が表示される．

#### プログラムの説明

#### ルートの定義
```app.get("/janken", (req, res) => {```

```app.get() ```
は, HTTP GET リクエストを処理するためのルートを設定している. 
```"/janken"```
は, このルートにアクセスする URLである. 
```req ```はリクエストオブジェクト, ```res``` はレスポンスオブジェクトである. 
#### クエリパラメータの取得
```let hand = req.query.hand;```

```let win = Number(req.query.win) || 0;```

```let lose = Number(req.query.lose) || 0; ```

```let total = Number(req.query.total) || 0;```

```req.query``` を使って, クライアントから送られてきたクエリパラメータを取得する. 
```hand ```はユーザーが選んだ手（「グー」「チョキ」「パー」）を取得する. 
```win, lose, total``` は, それぞれ勝ち数, 負け数, 合計試行回数を取得し, 数値に変換する. 値が提供されていない場合は 0 に初期化される. 
#### コンピュータの手をランダムに決定
```const num = Math.floor(Math.random() * 3 + 1);```

```let cpu = num === 1 ? "グー" : num === 2 ? "チョキ" : "パー";```

```Math.random() ```を使用して 1 から 3 のランダムな数値を生成する. 
```num``` の値に基づいて, コンピュータの手を「グー」「チョキ」「パー」のいずれかに決定する. 
#### 勝敗の判定
```let judgement = hand === cpu ? "引き分け" :```

```(hand === "グー" &cpu === "チョキ") || ```

```(hand === "チョキ" && cpu === "パー") ||```

```(hand === "パー" && cpu === "グー") ? "勝ち" : "負け";```

```hand``` と ```cpu``` を比較して, じゃんけんの結果を判定する. 
```hand``` と ```cpu``` が同じなら「引き分け」になる. 
```hand``` が勝つ条件をチェックして「勝ち」とし, それ以外の場合は「負け」とする. 
#### 勝ち数と負け数の更新
```if (judgement === "勝ち") {```
 
 ``` win++;```
```} else if (judgement === "負け") {```
  
  ```lose++; ```

```}```

```total++;```

結果が「勝ち」の場合, ```win ```を 1 増やす. 
結果が「負け」の場合, ```lose ```を 1 増やす. 
```total``` は毎回 1 増やして, 合計試行回数を更新する. 
#### 結果をクライアントに送信
```res.render("janken", { your: hand, cpu: cpu, judgement: judgement, win: win, lose: lose, total: total });```

```res.render()``` を使用して janken テンプレートをレンダリングする. 
```your, cpu, judgement, win, lose, total ```をテンプレートに渡し, ページに表示するために使用する.

#### 2. 逆しりとりヘルパー

##### 説明:
 ユーザーが入力した言葉の最後の文字を解析し, しりとりに使用できない次の言葉を提案する. 「ん」で終わる言葉を入力すると煽り文を添えて返されます. ひらがな以外の文字が入力された場合は, エラーメッセージが表示されるようになっている. 
##### 機能の詳細:

ユーザーが入力した言葉の最後の文字を取得し, 「ん」で終わるかを判定する. 
「ん」で終わらない場合は, 'ん'で終わる次の単語の候補を提示する. 
候補単語がない場合は, エラーメッセージが表示される. 

#### プログラムの説明

#### ルートの定義
```app.get("/shiritori", (req, res) => {```

```app.get() ```を使用して, ```/shiritori``` へのGETリクエストを処理するルートを定義している. 
```req``` はリクエストオブジェクト, ```res``` はレスポンスオブジェクトである. 
#### 初期化
```const word = req.query.word || "";```

```let nextWordSuggestion = "";```

```let isValidShiritori = true;```

```let gameOver = false;```

```req.query.word ```でクエリパラメータ ```word``` を取得する. もし ```word ```が提供されていない場合は空文字列 "" を使用する. 
```nextWordSuggestion ```は次の単語の候補を格納するための変数である. 
```isValidShiritori``` はしりとりのルールが有効かどうかを示すブール変数である. 
```gameOver``` はゲームオーバー状態かどうかを示すブール変数である. 

#### 入力された言葉の処理
 ```f (word) {```

  ```const lastChar = word.slice(-1);```

入力された ```word ```が存在する場合, その言葉の最後の文字を取得し, ```lastChar ```に格納する. 

#### ゲームオーバーのチェック
```if (lastChar === "ん") {```

 ``` gameOver = true;```

  ```nextWordSuggestion = "んで終わったら負けだよ〜〜〜ん！ｗ";```

```}```

```lastChar ```が「ん」で終わる場合, 煽り文を表示する. ```gameOver``` を ```true``` に設定し, ゲームオーバーのメッセージを `nextWordSuggestion` に設定する.

#### 次の単語の提案
`else {`

  `const shiritoriWords = {`
    `あ: ["あんてん", "あんぱん"],い: ["いんげん"], ///  わ: ["わんたん"]};`
  
  `if (shiritoriWords[lastChar]) {`

`nextWordSuggestion = shiritoriWords[lastChar];`
 ` } else {`
    `isValidShiritori = false;`
    `nextWordSuggestion = "ひらがなで打ってね^^";`

  `}`

`}`

「ん」で終わらない場合, `shiritoriWords` オブジェクトから次の単語の候補を探す. 
`lastChar` に対応する単語が `shiritoriWords `に存在すれば, それを `nextWordSuggestion `に設定する. 
もし `lastChar` が `shiritoriWords `に存在しなければ, `isValidShiritori` を `false `に設定し, エラーメッセージを `nextWordSuggestion` に設定する. 
#### レスポンスをレンダリング
`res.render("shiritori", { word: word, nextWord: nextWordSuggestion, valid: isValidShiritori, gameOver: gameOver });`

`res.render()` を使用して `shiritori `テンプレートをレンダリングする. 
`word,nextWord,valid,gameOver`などのデータをテンプレートに渡す. 

#### 3. メッセージジェネレーター機能

##### 説明: 
入力したテキストの文字数をカウントし, 「やさしく」または「罵倒する」の2種類のメッセージを生成する. 選択したタイプに応じて, 異なるトーンのメッセージが表示されるようになっている. 
##### 機能の詳細:
テキストの長さに応じて, 「やさしく」選択時はポジティブなメッセージを, そして「罵倒する」選択時は辛辣なメッセージを返す. 
メッセージはユーザーが入力した文字数を使用して動的に生成される. 

#### プログラムの説明
#### ルートの定義
`app.get("/message", (req, res) => {`

`app.get()` は，HTTP GET リクエストを処理するためのルートを設定する．
`"/message" `は，このルートにアクセスする URL パスである．
`req` はリクエストオブジェクトで，クライアントからのリクエスト情報を保持する．
`res`はレスポンスオブジェクトで，サーバーからクライアントへレスポンスを送信する．

#### クエリパラメータの取得
`const text = req.query.text || "";`

`const type = req.query.type || "やさしく";`

`req.query `を使って，クエリパラメータ` text` と `type` を取得する．
`text` が指定されていない場合は空文字列 "" が使われる．
`type` が指定されていない場合はデフォルトで「やさしく」が選ばれる．

#### メッセージの生成
`let responseMessage = "";`

`if (type === "罵倒する") {`
  `responseMessage = あんたの文章，ひどすぎるわ！${text.length}文字も無駄にしたわ！;`


`} else {`

  `responseMessage =  すごいね！${text.length}文字も使って素敵な文章を書けたね！;`

`}`

`responseMessage` は生成されるメッセージを格納する変数である．
`type` が「罵倒する」の場合：
辛辣なメッセージを生成し，`text.length `を使用してテキストの文字数をメッセージに含める．
それ以外（「やさしく」が選ばれている場合）：
ポジティブなメッセージを生成し，同様に` text.``length` を使って文字数を含める．

#### レスポンスをレンダリング
`res.render("message", { text: text, type: type, message: responseMessage });`

`res.render()` を使用して message テンプレートをレンダリングする．
テンプレートに渡されるオブジェクト `{ text: text, type: type, message: responseMessage } `には，ユーザーが入力した `text，`選択した `type，`そして生成された `responseMessage `が含まれている．
これにより，クライアントに対してメッセージの結果が表示される．

#### 全体的なサーバーの設定

サーバーはポート 8080 でリクエストを待ち受け, 各エンドポイントに応じて適切な機能を実行する. 
静的ファイル（画像や CSS など）は /public ディレクトリから提供される. 
各エンドポイント（/janken, /shiritori, /message）は, それぞれの機能に対応する EJS テンプレートを使用してレスポンスをレンダリングする. 

## 起動方法
### 1. サーバーの起動

以下のコマンドを使用してサーバーを起動する. 

```node app5.js```

サーバーが起動すると, http://localhost:8080 にアクセス(```例:localhost:8080/janken```)してアプリ
ケーションを使用することができる. 
### 2. Git での管理
ファイルを編集したら, Git を使用して変更を管理する. 

```git add .```

```git commit -m "変更内容の説明"```

```git push```


# 機能の説明と使用手順
### じゃんけん機能
#### ・機能の説明
ユーザーが「グー」「チョキ」「パー」のいずれかを選択し, コンピュータ
とじゃんけんを行う. 結果は「勝ち」「負け」「引き分け」として表示さ
れ, 勝ち数・負け数・合計回数が記録される. 
#### ・使用手順
1. /janken にアクセスする. 
2. ラジオボタンで「グー」「チョキ」「パー」を選択する. 
3. 「勝負する！」ボタンをクリックして結果を確認する. 
4. あなたの手, コンピュータの手, 結果, 勝ち数, 負け数, 合計回数が
表示される.

#### •コードの説明
hand はユーザーが選んだ手をクエリパラメータから取得することができる. コンピュー
タの手はランダムに決定され, 結果は比較して判定される. 勝ち数と負
け数はそれぞれカウントされ, ページに表示される. 
###  逆しりとりヘルパー機能
#### ・機能の説明
入力した言葉の最後の文字を解析し, しりとりを終わらせる単語を提
示する. 「ん」で終わると馬鹿にしてくる．
#### ・使用手順
 1. /shiritori にアクセスします. 
2. テキストボックスに言葉を入力し, 「次の単語を提案」ボタンをクリッ
クする. 
3. 次の候補単語が表示される. 「ん」で終わった場合は```んで終わったら負けだよ〜〜〜ん！ｗ```
と表示されます. 
#### ・コードの説明
入力された単語の最後の文字を取得し, しりとりの候補単語を提示する. 
「ん」で終わる場合はゲームオーバーと判定し, 適切なメッセージを表示する. 
2
### アメムチ文字数カウンター（メッセージジェネレーター）
#### ・機能の説明
入力されたテキストの文字数をカウントし, 「やさしく」または「罵倒する」
メッセージを生成する. 選択したタイプに応じて異なるメッセージが表示される. 
#### ・使用手順
1. /message にアクセスする. 
2. テキストエリアにテキストを入力する. 
3. ドロップダウンメニューから「やさしく」または「罵倒する」を選択する. 
4. 「メッセージを生成する」ボタンをクリックするとメッセージが表示される. 
### •コードの説明
text に入力されたテキストを取得し, 文字数をカウントする. 選択されたタイプに基づいて, 適切なメッセージを生成して表示する. 

